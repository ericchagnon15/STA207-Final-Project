---
title: "Final Project Proposal"
author: "Eric Chagnon, 920253076"
date: "2/18/2022"
output:
  html_document:
    df_print: paged
    number_sections: yes
---
```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.pos = 'H')
library(tidyverse)
```

***

***

## Introduction

The goal of this project is to try and determine if there is a relationship between the overall health of a country, and the resulting cases and deaths caused by Covid-19. This will be done by analyzing data from the World Health Organization (WHO) and metrics from each country, which are provided by the Central Intelligence Administration (CIA). Specifically, a model will be built with the percentage of the countries population that died from Covid-19, and that countries GDP, Literacy Rate, and Population density as treatment effects. 

All the current data is given in numeric form, so some slight feature engineering will need to be done in order to convert the predictors into factors.


```{r, warning=FALSE}
setwd("~/Downloads")
who = read_csv("https://covid19.who.int/WHO-COVID-19-global-data.csv")
country_data = read.csv("CIA_Country_Facts.csv")


```
The WHO dataset contains time series data for covid cases going from January 2020, to February 2022. The goal will be to extract the country and its total number of deaths from Covid 19. The data has the following form.
```{r, warning=FALSE}
head(who)
```

The CIA dataset contains a country and metrics like its population, GDP, Infant Mortality, etc. Here the goal will be to select the country name, GDP, Literacy Rate, and Population Density and then join these two datasets on the country name in order to get the final dataset. The CIA dataset has the following form.
```{r, warning=FALSE}
head(country_data)
```
Then the Total Deaths from the WHO dataset will be divided by the Population in the CIA dataset in order to get the percentage of population that died from Covid-19 as the final response variable. 


Finally, fit an ANOVA model and conduct diagnostics.


# Acknowledgement {-}


# Reference {-}

WHO dataset: https://covid19.who.int/table

CIA dataset: https://www.kaggle.com/abhishek252/cia-country-dataset-for-unsupervised-learning



## Apendix
```{r, echo=T,eval=FALSE}
library(haven)

harvard_dataset = read_sav("dataverse_files/STAR_Students.sav")


# 1 is small, 2 is normal, 3 is normal with aide
data = harvard_dataset[,c("g1classtype", "g1tchid", "g1schid", "g1tmathss")]
clean_data = na.omit(data)

length(table(clean_data$g1tchid)) #339 is number of classes
length(table(clean_data$g1schid)) #76 is number of schools

# group data by class (teacher)
grouped_data = aggregate(x = clean_data$g1tmathss,
                 by = list(clean_data$g1tchid, clean_data$g1classtype, clean_data$g1schid),
                 FUN = mean) 

colnames(grouped_data) = c("teacher.id", "class.type", "school.id", "average.math.score")
grouped_data$teacher.id = as.factor(grouped_data$teacher.id)
grouped_data$school.id = as.factor(grouped_data$school.id)
grouped_data$class.type = as.factor(grouped_data$class.type)

###################


pairs(grouped_data)


library(ggplot2)

ggplot(grouped_data, aes(x=class.type, y=average.math.score, fill=class.type)) +
  geom_boxplot() +
  ggtitle('Math Score by Class Type') 

ggplot(grouped_data, aes(x=school.id, y=average.math.score, fill=school.id)) +
  geom_boxplot() +
  ggtitle('Math Score by School ID') 

##############

star_aov = aov(average.math.score~class.type+school.id, data = grouped_data)
summary(star_aov)

x = TukeyHSD(star_aov, conf.level = 1-.05, which = "class.type")

x

plot(x)

###############

par(mfrow=c(2,2))
plot(star_aov)

par(mfrow=c(1,1))
hist(star_aov$residuals)

library(car)

leveneTest(average.math.score~class.type, data = grouped_data) #grouped_data

```

# Session info {-}

<span style='color:blue'>
Report information of your `R` session for reproducibility. 
</span> 


```{r}
sessionInfo()
```